<head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.1/js/bootstrap.js"></script>
 <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.1/css/bootstrap.min.css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
   <link href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.2/angular.min.js"></script>
  <script src="https://unpkg.com/vexflow@3.0.9/releases/vexflow-min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/soundfont-player@0.12.0/dist/soundfont-player.min.js"></script>
   <link rel="manifest" href="/manifest.json">
</head>


<style>
  
   body {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}

   .staffContainer{display: flex; justify-content: center; }
 #staff { border: 1px solid #ccc;  overflow-x: auto; overflow-y: auto ; height: 450px; }
   #status { position: absolute; margin-top: -25px !important; font-size: 16px; }
    .correct { color: green; }
    .wrong { color: red; }
  
      .close-btn {
  position: absolute;
  top: 1.7rem;
  right: 1.7rem;
  background-color: rgba(0, 0, 0, 0.8);
  border: none;
  border-radius: 50%;
  width: 32px;
  height: 32px;
  color: white;
  font-size: 1.2rem;
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.close-btn:hover {
  background-color: rgba(0, 0, 0, 0.5);
}

  
.dashboard-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 15px;
}  

.text-orange {color: #ff8300}
  .text-golden {
         color: orange;
  text-shadow: 0 0 10px orange;
        }
  .text-blue {color: #20a2f1}
  .text-green {color: green}

/*-- Dashboard panel --*/ 
.dashboard-panel {margin: 10px 0 20px; }
.dashboard-panel .panel-header {position: relative; background: #434444; color: #FFF; border-radius: 0.15em;}
.dashboard-panel .panel-header > * {display: block; }
.dashboard-panel .panel-header h4 {margin: 0; padding: 6px; font-size: 18px; }
.dashboard-panel .panel-header h4 i {color: #d8d8d8; }

.dashboard-panel .panel-body {margin-top: 10px; max-height: 225px; border: 1px solid #d8d8d8; overflow-y: auto; }
 
/*-- Datos del usuario --*/
.profile-user-data {padding: 10px 0;}
.profile-user-data > * {float: left;}
 .profile-user-data   .circle {
    border-radius: 100% !important;
    overflow: hidden;
    width: 95px;
    height: 95px;
   margin-right: 10px;
}
.profile-user-data img { margin-right: 10px; max-width: 100px;}
.profile-user-data .main-data {padding: 10px 0 20px; margin-bottom: 15px; width: calc(100% - 115px);}
.profile-user-data .main-data h4 {margin: 0; font-size: 20px; font-weight: }
.profile-user-data .main-data span {font-size: 12px;}

/*-- Números del usuario --*/
.user-stats {padding: 20px 5px; border-top: 3px solid #e6e6e6;}
.user-stats > * {margin: 0;}
.user-stats .achievement-count {font-size: 20px;}
.user-stats .achievement-count i {margin-right: 10px;  font-size: 28px;}
.user-stats .achievement-count span {margin: 0 5px; color: #55565a; opacity: 0.6;}
.user-stats .achievement-count span.acive {font-size: 28px; opacity: 1;}
.user-stats .currency-count li {padding: 2px 0 2px 5px;}
.user-stats .currency-count li span {color: #77777a; font-size: 18px;}
.user-stats .currency-count li i {
  width: 34px; height: 34px;
  padding: 8px 0;
  background: #ff8300;
  border-radius: 50%;
  box-shadow: inset 0 0 0 3px #ff8300, inset 0 0 0 5px rgba(255,255,255,0.4);
  color: #FFF;
  font-size: 19px;
  text-align: center;
  
}

/*-- Últimos logros obtenidos --*/
.user-achievements {padding: 15px 20px 10px; background: #eff3f9;}
.user-achievements h3 {margin: 0 0 20px 0;}
.user-achievements ul li {width: calc(100% /6 - 5px); padding: 3px; vertical-align: middle;}
.user-achievements ul li a {display: block; height: 54px; width: 54px; margin: auto; padding: 8px 0; border: 3px solid #77777a; border-radius: 50%; color: #a5a5a5; font-size: 12px; text-align: center;}
.user-achievements ul li a i {font-size: 31px;}
.user-achievements ul li a:hover,
.user-achievements ul li a:focus {background: rgba(0,0,0,0.08)}
.user-achievements ul li a.see-more {border: none; width: 100%; padding: 10px 0; border-radius: 0; color: #ff6b00; line-height: 0.8}
.user-achievements ul li a.see-more > * {display: block;}
.user-achievements ul li a.see-more span {font-size: 28px; margin-bottom: 5px;}
.user-achievements ul li a.see-more small {display: block; margin-top: 0; font-size: 12px; text-decoration: underline;}
.user-achievements ul li a.see-more:hover,
.user-achievements ul li a.see-more:focus {background: rgba(0,0,0,0.05); text-decoration: none;}


/*-- Registro de actividad --*/
.log-list-container {margin: 0; padding: 15px;}
.log-list-container ul {position: relative; margin: -15px 0; padding: 0; }
.log-list-container ul:before {content: ""; display: block; position: absolute; top: 20px; bottom: 20px; left: 8px; width: 4px; background: #a5a5a5; }
.log-list-container li {display: block; position: relative; padding: 10px 15px 10px 35px; color: #666; font-size: 12px;}
.log-list-container li > * {display: block; }
.log-list-container li:before { display: block; position: absolute; top: 50%; left: -5px; width: 30px; height: 30px; margin-top: -15px; padding: 7px 0; background: silver; border-radius: 50%;  font: normal normal normal 16px/1 FontAwesome; text-align: center; }
.log-list-container li small {opacity: 0.7; }

  @keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.18); }
  100% { transform: scale(1); }
}
  

@keyframes ring {
  0% {
    box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.7);
  }
  40% {
    box-shadow: 0 0 0 10px rgba(255, 0, 0, 0);
  }
  80% {
    box-shadow: 0 0 0 10px rgba(255, 0, 0, 0);
  }
  100% {
    box-shadow: 0 0 0 0 rgba(255, 0, 0, 0);
  }
}
  
  @keyframes ringyellow {
   0% {
    box-shadow: 0 0 0 0 rgba(255, 165, 0, 0.7); /* Color naranja */
  }
  40% {
    box-shadow: 0 0 0 10px rgba(255, 165, 0, 0); /* Color naranja */
  }
  80% {
    box-shadow: 0 0 0 10px rgba(255, 165, 0, 0); /* Color naranja */
  }
  100% {
    box-shadow: 0 0 0 0 rgba(255, 165, 0, 0); /* Color naranja */
  }
}

@keyframes animateHeart {
0% {transform: scale(1); } 
5% {transform: scale(1.2); } 
10% {transform: scale(1.1); } 
15% {transform: scale(1.3); } 
50% {transform: scale(1); } 
100% {transform: scale(1); } 
}
 
  @keyframes load {
  0% { transform: rotate(0); }
  100% { transform: rotate(360deg); }
}

  @keyframes rotate-icon {
    0% { transform: rotate(0deg); }
    50% { transform: rotate(180deg); }
    50.01% { transform: rotate(180deg); }
    100% { transform: rotate(360deg); }
}
  

.status-pending:before {
 content: "\f021";
  animation: load 1.5s steps(900, end) infinite;
}
  

  


  
   .status-delayed:before {
  content: "\f071"; /* Example icon for completed status */
     animation: ringyellow 1s infinite;
}
  .status-completed:before {
  content: "\f00c"; /* Example icon for completed status */
    color: green;
}

   .status-error:before {
  content: "\f057"; /* Example icon for completed status */
     color: red;
        animation: ring 1.5s infinite;
}

  .status-default:before {
    content: "\f11d"; 
}
  
  .yticon{
    animation: pulse 1s ease-in-out infinite;
  }
  
  .yticon.no-animation {
  animation: none;
}


/*-- Logros --*/
.achievement-list-panel .panel-body {padding: 0 10px; max-height: 570px;}
.achievement-list-panel .panel-body .list-unstyled li {padding: 10px 0; display: -webkit-box; display: -ms-flexbox; display: flex; -webkit-box-align:center; -ms-flex-align:center; -ms-grid-row-align:center; align-items:center;}
.achievement-list-panel .panel-body .list-unstyled li:not(:last-child) {border-bottom: 1px dashed #cccccc}
.achievement-list-panel .panel-body .list-unstyled li .achievement-icon {-webkit-box-flex: 1;-ms-flex: 1 0 70px; flex: 1 0 70px; margin-right: 15px;}
.achievement-list-panel .panel-body .list-unstyled li .achievement-icon i {display: block; height: 70px; width: 70px; padding: 11px 0; border: 3px solid #cccccc; border-radius: 50%; color: #cccccc; font-size: 40px; text-align: center;}
.achievement-list-panel .panel-body .list-unstyled li .achievement-content {color: #55565a;}
.achievement-list-panel .panel-body .list-unstyled li .achievement-content > * {display: block;}
.achievement-list-panel .panel-body .list-unstyled li .achievement-content strong {font-size: 15px;}
.achievement-list-panel .panel-body .list-unstyled li .achievement-content p {margin: 0; font-size: 14px;}
.achievement-list-panel .panel-body .list-unstyled li .achievement-actions {margin-left: 15px;}
.achievement-list-panel .panel-body .list-unstyled li .achievement-actions a {display: block; color: #55565a; font-size: 18px; white-space: nowrap; }
.achievement-list-panel .panel-body .list-unstyled li .achievement-actions a i {font-size: 21px !important;}

.achievement-list-panel .panel-body .list-unstyled li.completed .achievement-icon i {position: relative; border-color: #ff9e16; color: #ff9e16}
.achievement-list-panel .panel-body .list-unstyled li.completed .achievement-icon i:after {content: "\f00c"; display: block; position: absolute; top: 0px; right: 0px; width: 18px; height: 18px; padding: 3px 0; background: #ff9e16; border-radius: 50%; color: #FFF; font: normal normal normal 13px/1 FontAwesome; text-align: center;}
.achievement-list-panel .panel-body .list-unstyled li.completed .achievement-content strong {color: #ff9e16}
.achievement-list-panel .panel-body .list-unstyled li.completed .achievement-actions a {font-weight: bold; color: #ff9e16}


/*-- Tienda --*/
.store-header {margin-bottom: 15px; padding: 3px 15px; border-bottom: 5px solid #ff9e16;}
.store-header i {margin-right: 10px;}

.store-list-panel .panel-body {max-height: 420px;}
.store-list-panel .panel-body .list-unstyled li {padding: 10px 0; display: -webkit-box; display: -ms-flexbox; display: flex; -webkit-box-align:center; -ms-flex-align:center; -ms-grid-row-align:center; align-items:center;}
.store-list-panel .panel-body .list-unstyled li > * {}
.store-list-panel .panel-body .list-unstyled li .prize-thumbnail {-webkit-box-flex: 0;-ms-flex: 0 0 90px; flex: 0 0 90px; margin-right: 15px;}
.store-list-panel .panel-body .list-unstyled li .prize-thumbnail div {width: 100%; padding-top: 70%; background: center center no-repeat; background-size: cover}
.store-list-panel .panel-body .list-unstyled li .prize-description {-webkit-box-flex: 1;-ms-flex: 1 0 auto; flex: 1 0 auto; margin-right: 15px;}
.store-list-panel .panel-body .list-unstyled li .prize-description > * {display: block; width: 100%;}
.store-list-panel .panel-body .list-unstyled li .prize-description small i {height: 18px; width: 18px; padding: 4px 0; background: rgba(0,0,0,0.7); border-radius: 50%; color: #FFF; text-align: center;}
.store-list-panel .panel-body .list-unstyled li .prize-actions {padding: 10px 0 10px 20px}
.store-list-panel .panel-body .list-unstyled li .prize-actions .btn {padding: 7px 18px; border-radius: 0; background: #dddddd; text-transform: uppercase; border: none;}
.store-list-panel .panel-body .list-unstyled li .prize-actions .btn:hover,
.store-list-panel .panel-body .list-unstyled li .prize-actions .btn:focus {background: #ff9e16; color: #FFF;}



.progress{

  margin-top: 5px;
  margin-bottom: -25px;
}



.showbox {
  display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.loader {
  position: relative;
  margin: 0px auto;
  width: 100px;
}
.loader:before {
  content: "";
  display: block;
  padding-top: 100%;
}

.circular {
  -webkit-animation: rotate 2s linear infinite;
          animation: rotate 2s linear infinite;
  height: 100%;
  transform-origin: center center;
  width: 100%;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  margin: auto;
}

.path {
  stroke-dasharray: 1, 200;
  stroke-dashoffset: 0;
  -webkit-animation: dash 1.5s ease-in-out infinite, color 6s ease-in-out infinite;
          animation: dash 1.5s ease-in-out infinite, color 6s ease-in-out infinite;
  stroke-linecap: round;
}

@-webkit-keyframes rotate {
  100% {
    transform: rotate(360deg);
  }
}

@keyframes rotate {
  100% {
    transform: rotate(360deg);
  }
}
@-webkit-keyframes dash {
  0% {
    stroke-dasharray: 1, 200;
    stroke-dashoffset: 0;
  }
  50% {
    stroke-dasharray: 89, 200;
    stroke-dashoffset: -35px;
  }
  100% {
    stroke-dasharray: 89, 200;
    stroke-dashoffset: -124px;
  }
}
@keyframes dash {
  0% {
    stroke-dasharray: 1, 200;
    stroke-dashoffset: 0;
  }
  50% {
    stroke-dasharray: 89, 200;
    stroke-dashoffset: -35px;
  }
  100% {
    stroke-dasharray: 89, 200;
    stroke-dashoffset: -124px;
  }
}
@-webkit-keyframes color {
  100%, 0% {
    stroke: #d62d20;
  }
  40% {
    stroke: #0057e7;
  }
  66% {
    stroke: #008744;
  }
  80%, 90% {
    stroke: #ffa700;
  }
}
@keyframes color {
  100%, 0% {
    stroke: #d62d20;
  }
  40% {
    stroke: #0057e7;
  }
  66% {
    stroke: #008744;
  }
  80%, 90% {
    stroke: #ffa700;
  }
}
  
  
  
.profile-pic {
  width: 100px;
  height: 100px;
  margin-left: -2px;
  border-radius: 50%;
  -o-object-position: center;
     object-position: center;
  -o-object-fit: cover;
     object-fit: cover;
} 
   
.p-image {
  top: 105px;
  left: 20px;
  position: absolute;
  color: #666666;
  transition: all .3s cubic-bezier(.175, .885, .32, 1.275);
}

  

  
  .modal-container {
    position: fixed;
    display: table;
    height: 100%;
    width: 100%;
    top: 0;
    left: 0;
    transform: scale(0);
    z-index: 1;
  }

  .modal-container.four {
    z-index: 0;
    transform: scale(1);
  }

  .modal-container.four .modal-background .modal {
    animation: blowUpModal 0.5s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
  }
  .modal-container.four + body {
    z-index: 1;
    animation: blowUpContent 0.5s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
  }
  .modal-container.four.out .modal-background .modal {
    animation: blowUpModalTwo 0.5s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
  }
  .modal-container.four.out + body {
    animation: blowUpContentTwo 0.5s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
  }

  .modal-container .modal-background {
    display: table-cell;
    background: rgba(0, 0, 0, 0.8);
    text-align: center;
    vertical-align: middle;
  }
  .modal-container .modal-background .modal {
    padding: 50px;
    display: inline-block;
    border-radius: 3px;
    font-weight: 300;
    position: relative;

  }

  @keyframes blowUpContent {
    0% {
      transform: scale(1);
      opacity: 1;
    }
    99.9% {
      transform: scale(2);
      opacity: 0;
    }
    100% {
      transform: scale(0);
    }
  }
  @keyframes blowUpContentTwo {
    0% {
      transform: scale(2);
      opacity: 0;
    }
    100% {
      transform: scale(1);
      opacity: 1;
    }
  }
  @keyframes blowUpModal {
    0% {
      transform: scale(0);
    }
    100% {
      transform: scale(1);
    }
  }
  @keyframes blowUpModalTwo {
    0% {
      transform: scale(1);
      opacity: 1;
    }
    100% {
      transform: scale(0);
      opacity: 0;
    }
  }
  
  
 
  
  
  

  .menu-bar {
            display: flex;
            justify-content: space-around;
            background-color: black;
            padding: 10px 0;
            list-style: none;
            margin: 0;
             border-radius: 10px;
            font-weight: 550;
  box-shadow: 0px 8px 20px -8px rgba(26, 33, 43, 0.5), 0px 4px 12px 0px rgba(26, 33, 43, 0.05), 0px 1px 3px 0px rgba(26, 33, 43, 0.25), 0px 1.5px 0.5px 0px #454D57 inset, 0px -3px 1px 0px rgba(0, 0, 0, 0.5) inset;
        }

        .menu-bar li {
            color: white;
          transition: transform 0.2s;
        }

        .menu-bar a {
            color: white;
            text-decoration: none;
            padding: 10px 20px;
        }

.menu-bar li:hover {
  color: white;
            text-decoration: none;
    transform: scaleX(1.03) scaleY(1.06) translateZ(0);
}

.menu-bar li:active {
   color: white;
   text-decoration: none;
    transform: scale(0.96) translateZ(0);
}



 .player-bar {
     font-size: 14px;
     font-weight: bold;
     width: 100%;
     display: flex;
     flex-flow: row nowrap;
     margin: 10px 0;
}

 




  
  #modal-container2 {
    font-family: Helvetica, sans-serif;
    position: fixed;
    display: table;
    height: 100%;
    width: 100%;
    top: 0;
    left: 0;
    transform: scale(0);
    z-index: 1;
  }

  #modal-container2.four {
    z-index: 0;
    transform: scale(1);
  }

  #modal-container2.four .modal-background .modal-msg {
    animation: blowUpModal 0.5s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
  }
  #modal-container2.four + body {
    z-index: 1;
    animation: blowUpContent 0.5s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
  }
  #modal-container2.four.out .modal-background .modal-msg {
    animation: blowUpModalTwo 0.5s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
  }
  #modal-container2.four.out + body {
    animation: blowUpContentTwo 0.5s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
  }

  #modal-container2 .modal-background {
    display: table-cell;
    background: rgba(0, 0, 0, 0.8);
    text-align: center;
    vertical-align: middle;
  }
  #modal-container2 .modal-background .modal-msg {
    padding: 10px;
    width: 95%;
    display: inline-block;
    border-radius: 13px;
    background: #fef2cc;
    font-weight: 300;
    position: relative;
    max-height: 530px;
    overflow: auto !important;
  }



  @keyframes blowUpContent {
    0% {
      transform: scale(1);
      opacity: 1;
    }
    99.9% {
      transform: scale(2);
      opacity: 0;
    }
    100% {
      transform: scale(0);
    }
  }
  @keyframes blowUpContentTwo {
    0% {
      transform: scale(2);
      opacity: 0;
    }
    100% {
      transform: scale(1);
      opacity: 1;
    }
  }
  @keyframes blowUpModal {
    0% {
      transform: scale(0);
    }
    100% {
      transform: scale(1);
    }
  }
  @keyframes blowUpModalTwo {
    0% {
      transform: scale(1);
      opacity: 1;
    }
    100% {
      transform: scale(0);
      opacity: 0;
    }
  }

  .modal-hidden .modal-background {
    background: transparent;
  }

.close-video-modal {
    display: block;
    position: absolute;
    left: 0;
    top: -40px;

    text-decoration: none;
    font-size: 20px;
    font-weight: bold;
    color: #fff;
}


  








.video-modal,
.video-modal .overlay {
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    z-index: 3000;
}
.video-modal {
  overflow: hidden;
  position: fixed;
  opacity: 0.0;

  -webkit-transform: translate(500%,0%);
  transform: translate(500%,0%);

  -webkit-transition: -webkit-transform 0s linear 0s;
  transition: transform 0s linear 0s;


  /* using flexbox for vertical centering */

  /* Flexbox display */
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;

  /* Vertical alignment */
  -webkit-box-align: center;
  -moz-box-align: center;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;

  -webkit-transform-style: preserve-3d;
  -moz-transform-style: preserve-3d;
  transform-style: preserve-3d;
}
.video-modal .overlay {
  z-index: 0;
  background-color: rgba(0, 0, 0, 0.6);
    filter: blur(14px);



  opacity: 0.0;

  -webkit-transition: opacity 0.2s ease-out 0.05s;
  transition: opacity 0.2s ease-out 0.05s;
}


.video-modal-content {
  position: relative;
  top: auto;
  right: auto;
  bottom: auto;
  left: auto;
  z-index: 1;
  border-radius: 13px;
  margin: 0 auto;

  overflow-y: visible;

  background: #000;
  
  width: calc(100% - 12em);
  height: 0;
  padding-top: calc((100% - 12em) * 0.5625); /* 16:9 calc */
}

/* Scaling to fit within the current Viewport size:
   When viewport aspect ratio is greater than 16:9
   work off the height instead of the width for calc */
 @media (min-aspect-ratio: 16/9) {
  .video-modal-content {
    width: 0;
    height: calc(100vh - 10em);
    padding-top: 0;
    padding-left: calc((100vh - 10em) * 1.7778); /* 16:9 calc */
  }
}

/* Mobile Layout Tweaks - side margins reduced */
@media (max-width: 640px) {
  .video-modal-content {
    width: calc(100% - 1em);
    padding-top: calc((100% - 1em) * 0.5625); /* 16:9 calc */
  }
}

/* modal close button */
.close-video-modal {
  display: block;
    position: absolute;
    left: 0;
    top: -40px;

    text-decoration: none;
    font-size: 20px;
    font-weight: bold;
    color: #fff;
}

/* set the iframe element to stretch to fit its parent element */
iframe#youtube {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1;
  border-radius: 13px;


  background: white;
  box-shadow: 0px 2px 16px rgba(0,0,0,0.5);
}

/* show the modal: 
   add class to the body to reveal */
.show-video-modal .video-modal {
  opacity: 1.0;

  transform: translate(0%,0%);
  -webkit-transform: translate(0%,0%);
}
.show-video-modal .video-modal .overlay {
  opacity: 1.0;
}
.show-video-modal .video-modal-content {
  transform: translate(0%,0%);
  -webkit-transform: translate(0%,0%);
}






    .modal {
      display: none;
      position: fixed;
      z-index: 1;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.4);
      padding-top: 60px;
    }

    .modal-content {
      background-color: #fefefe;
      margin: 5% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      max-width: 300px;
    }

    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
    }

    .close:hover,
    .close:focus {
      color: black;
      text-decoration: none;
      cursor: pointer;
    }

    .add-to-btn {
      background-color: #E02D44;
      color: white;
      border: none;
      outline: none;
      font-weight: bold;
      width: 100%;
      height: 50px;
    }
 
#myModal {
    display: block; 
  }






#full-screen-btn{
    position: absolute;
            justify-content: space-around;
            background-color: black;
            color: white; 
  text-decoration: none;
            padding: 10px 20px;
  margin-top: 90px;
             border-radius: 10px;
            font-weight: 550;
  box-shadow: 0px 8px 20px -8px rgba(26, 33, 43, 0.5), 0px 4px 12px 0px rgba(26, 33, 43, 0.05), 0px 1px 3px 0px rgba(26, 33, 43, 0.25), 0px 1.5px 0.5px 0px #454D57 inset, 0px -3px 1px 0px rgba(0, 0, 0, 0.5) inset;
  }


@media screen and (min-width:576px){
   
   .metronome { 
     margin-top: -50px;
     margin-left: -130px;
  }
  .menu-bar{
    position: absolute; 
    margin-top: -460px;
     margin-left: -65px;
  }
  #full-screen-btn{
  margin-left: 120px;
  margin-top: 35px;
}

  .mic-container{
    margin-top: -20px;
    margin-left: 380px;
  }
.mic-container span{
 margin-top: 55px;
    margin-left: -15px;
  }
  #record-audio{
    margin-top: 75px;
    margin-left: -465px;
  }
  
}
  
   @media screen and (min-width:700px){

      .metronome { 
     margin-left: -200px;
  }
  .menu-bar{
     margin-left: -135px;
  }

     .mic-container{
    margin-left: 450px;
  }

      #full-screen-btn{
  margin-left: 50px;
}
      #record-audio{
    margin-left: -535px;
  }
     #lsnContainer{
       height: 285px !important;
       max-height: 285px !important;
     }
     
     .profile-user-data{
       margin-top: 20px;
     }
     
     .p-image{
       margin-top: 20px;
     }
     
   
}
  
 

.strong-shadow {
  color: white;
  text-shadow: 1px 2px 3px black, 0px 8px 13px black, 0px 18px 23px black!important;  
}

.strong-white {
  color: white;
  text-shadow: 1px 2px 3px silver, 0px 8px 13px silver, 0px 18px 23px silver!important;  
}


.intro-section {
  background-image: url(https://lh3.googleusercontent.com/d/1XBWyFeO4wVvB8jgYlGjywplnTQjiJJnw);
  background-size: cover;
  background-repeat: no-repeat;
  background-position: center;
  padding: 75px 95px;
  min-height: 100vh;
  height: 100vh;
  display: -webkit-box;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
          flex-direction: column;
  color: #ffffff; }
  @media (max-width: 991px) {
    .intro-section {
      padding-left: 50px;
      padding-rigth: 50px; } }
  @media (max-width: 767px) {
    .intro-section {
      padding: 28px; } }
  @media (max-width: 575px) {
    .intro-section {
      min-height: auto; display:none;}    
}


.brand-wrapper .logo {
  height: 35px; }

@media (min-width: 767px) {
  .brand-wrapper {
    margin-top: -35px; } }

.intro-content-wrapper {
  width: 410px;
  max-width: 100%;
  margin-left: -50px;
  margin-top: 250px;
  margin-bottom: auto; }
  .intro-content-wrapper .intro-title {
    font-size: 40px;
    font-weight: bold;
    margin-bottom: 17px; }
  .intro-content-wrapper .intro-text {
    font-size: 19px;
    line-height: 1.37; }
  .intro-content-wrapper .btn-read-more {
    background-color: #fff;
    padding: 7px 30px;
    border-radius: 0;
    font-size: 16px;
    font-weight: bold;
    color: #000; }
    .intro-content-wrapper .btn-read-more:hover {
      background-color: transparent;
      border: 1px solid #fff;
      color: #fff; }


.intro-section-footer .footer-nav a {
  font-size: 20px;
  font-weight: bold;
  color: inherit; }
  @media (max-width: 767px) {
    .intro-section-footer .footer-nav a {
      font-size: 14px; } }
  .intro-section-footer .footer-nav a + a {
    margin-left: 30px; }

.form-section {
  display: -webkit-box;
  display: flex;
  -webkit-box-align: center;
          align-items: center;
  -webkit-box-pack: center;
          justify-content: center; }
  @media (max-width: 767px) {
    .form-section {
      padding: 35px; } }

.login-wrapper {
  width: 300px;
  max-width: 100%; }
  @media (max-width: 575px) {
    .login-wrapper {
      width: 100%; } }
  .login-wrapper .form-control {
    border: 0;
    border-bottom: 1px solid #e7e7e7;
    border-radius: 0;
    font-size: 14px;
    font-weight: bold;
    padding: 15px 10px;
    margin-bottom: 7px; }
    .login-wrapper .form-control::-webkit-input-placeholder {
      color: #b0adad; }
    .login-wrapper .form-control::-moz-placeholder {
      color: #b0adad; }
    .login-wrapper .form-control:-ms-input-placeholder {
      color: #b0adad; }
    .login-wrapper .form-control::-ms-input-placeholder {
      color: #b0adad; }
    .login-wrapper .form-control::placeholder {
      color: #b0adad; }

.login-title {
  font-size: 30px;
  font-weight: bold;
  margin-bottom: 30px; }

.login-btn {
  padding: 13px 30px;
  background-color: #000;
  border-radius: 0;
  font-size: 20px;
  font-weight: bold;
  color: #fff; 
  }
  .login-btn:hover {
    border: 1px solid #000;
    background-color: transparent;
    color: #000; }

.forgot-password-link {
  font-size: 14px;
  color: #080808;
  text-decoration: underline; }

.social-login-title {
  font-size: 15px;
  color: #919aa3;
  display: -webkit-box;
  display: flex;
  margin-bottom: 23px; }
  .social-login-title::before, .social-login-title::after {
    content: "";
    background-image: -webkit-gradient(linear, left top, left bottom, from(#f4f4f4), to(#f4f4f4));
    background-image: linear-gradient(#f4f4f4, #f4f4f4);
    -webkit-box-flex: 1;
            flex-grow: 1;
    background-size: calc(100% - 20px) 1px;
    background-repeat: no-repeat; }
  .social-login-title::before {
    background-position: center left; }
  .social-login-title::after {
    background-position: center right; }

.social-login-links {
  text-align: center;
  margin-bottom: 32px; }

.social-login-link img {
  width: 40px;
  height: 40px;
  -o-object-fit: contain;
     object-fit: contain; }

.social-login-link + .socia-login-link {
  margin-left: 16px; }

.login-wrapper-footer-text {
  font-size: 14px;
  text-align: center; }













.flex-flex {
    display: flex;
}
.align-center {
  align-items: center; 
}
.center-center {
  align-items: center;
  justify-content: center;
}

.flex-direction--column {
    -ms-flex-direction: column;
    flex-direction: column;
}


.padding-top--64 {
  padding-top: 64px;
}
.padding-top--24 {
  padding-top: 24px;
}

.padding-bottom--24 {
  padding-bottom: 24px;
}
.padding-horizontal--48 {
  padding: 48px;
}
 
/* @media (max-width: 575px) {
    .padding-horizontal--48 {
  padding: 1px;
} }*/
.padding-bottom--15 {
  padding-bottom: 15px;
}


.flex-justifyContent--center {
  -ms-flex-pack: center;
  justify-content: center;
}




.footer-link span {
  margin-top: 140px;
    font-size: 14px;
    text-align: center;
}
.listing a {
    color: #697386;
    font-weight: 600;
    margin: 0 10px;
}




 .login-container {
            text-align: center;
            max-width: 400px;
   height: 60vh; 
            margin: auto;
            padding: 20px;
            background-color: white;
     
   
        }

.logo-img {
    max-width: 130px; 
    height: auto; 
    display: block; 
  border-radius: 50%;
    margin-left: auto;
    margin-right: auto;
}

        .login-btn, .back-btn {
            display: block;
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
        }

.login-btn-icon{
  margin-right: 5px; 
  margin-top: -7px;
  font-size: 22px;
  float: left;
}
     
       .login-btn-email, .g_id_signin {
    /*width: 83%;*/
    height: 40px;
    border: 1px solid #dadce0;
    border-radius: 4px;
    background-color: #fff;
    color: #3c4043;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    transition: background-color 0.3s ease;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    margin-top: 12px;
}

.login-btn-email:hover {
    background-color: #f7f8f8;
}

.login-btn-email:focus {
    outline: none;
    box-shadow: 0 0 3px 2px rgba(66, 133, 244, 0.3);
}
      

        .signup-link {

           margin-top: 10px;

        }

        .signup-link a {
            color: #1a73e8;
            text-decoration: none;
        }

        .signup-link a:hover {
            text-decoration: underline;
        }

      #whatsapp-login {
            margin-top: 30px;
            display: none;
        }

        #maillogin, #signupform {
            margin-top: 20px;
            display: none;
        }

        #login-options {
            display: block;
        }

        .back-btn {
            background-color: #f2f2f2;
            color: #555;
        }

        .back-btn:hover {
            background-color: #e0e0e0;
        }



.accordionContainer {
  position: absolute;
  left: 0;
  width: 100%;
  padding: 10px;
}


.accordionWrap {
  margin: 0 auto;
  padding: 0;
  overflow-y: auto;
  border: 1px solid rgba(0, 0, 0, 0.1);
  padding: 5px 5px 0 5px;
  border-left: none;
  border-right: none;
  height: 380px;
}

.accordion-block {
  list-style: none;
  background-color: rgba(0, 0, 0, 0.05);
  padding: 10px 15px 10px 25px;
  border: 1px solid #CCC;
  box-shadow: inset 1px 1px 0 rgba(255, 255, 255, 0.5);
  margin-bottom: 5px;
  width: 100%;
  box-sizing: border-box;
  cursor: pointer;
  border-radius: 3px;
}

</style>

<div ng-app="studentsApp" ng-controller="Controller1" >
  
   <div id="myModal" class="modal" ng-show="isModalVisible" ng-click="checkCloseModal($event)">
    <div class="modal-content"> 
      <span class="close" ng-click="closeModal()">&times;</span>
      <button class="add-to-btn" ng-click="addToHomeScreen()">Agregar a pantalla de inicio</button>
    </div>
  </div>
  
 
<div class="container-fluid" id="loginContainer">
      <div class="row">
        <div class="col-sm-6 col-md-7 intro-section">
          <div class="brand-wrapper strong-shadow" style="margin-left: -40px;">
            <h1>Mozart Academy</h1>
          </div>
          <div class="intro-content-wrapper">
        
            <h1 class="intro-title strong-shadow">Bienvenido al mundo del Piano!</h1>
            <p class="intro-text strong-shadow">En Mozart Academy, te ofrecemos clases adaptadas a tus necesidades y horarios, ya seas principiante o avanzado.</p>
     
          </div>
        </div>
        
        
        
        
         <div class="col-sm-6 col-md-5 box-root padding-top--24 flex-flex flex-direction--column" style="flex-grow: 1; z-index: 9; ">
       
   
          
        <div class="formbg-outer" >
          <div class="formbg">
      
              <div class="login-container d-flex flex-column justify-content-between min-vh-100">
                
              
                 
       <div id="login-options">
           <img src="https://lh3.googleusercontent.com/d/1EIVHue1UhcSP-82ftLN01xyi_yp7s0de"  class="logo-img my-3">
    <h4 class="mt-3" >Inicia sesión</h4>
        

    <div class="flex-grow-1 d-flex flex-column justify-content-center align-items-center">
      
      
   <div class="buttons-container" >     
   <button class="login-btn login-btn-email" onclick="showWhatsappLogin()" style="margin-top: 100px;"><i class="ri-login-box-fill login-btn-icon" style=" color: black; "></i> <span >Acceder</span></button>
   
         </div>
    </div>

  
</div> 
                
       <section id="whatsapp-login" style="display: none;">
 <!-- <select ng-model="orderList">
    <option value="name">Nombre</option>
    <option value="schedule">Horario</option>
    <option value="status">Status</option>
  </select> -->
   <!--   <input type="text" id="query" ng-model="query"/> -->
         <div ng-model="orderList" >
     <button class="btn btn-success" ng-click="filterByHour()">
    Ahora
  </button>
     <button class="btn btn-info" ng-click="filterByDay()">
    Hoy
  </button>
  <button class="btn btn-primary" ng-click="showAllStudents()">
    Todos
  </button>
         
         </div>
         
         
  <div  class="accordionContainer">
    
  <ul id="notebook_ul" class="accordionWrap">
    
     <div ng-if="noStudentsMessage" class="alert alert-danger" style="margin-top: 100px;">
         {{ noStudentsMessage }}
        </div>
    
    <li class="accordion-block" ng-repeat="student in filteredStudents | filter: { name: query } | orderBy: orderList" id="active" ng-style="{'background-image': 'linear-gradient(90deg, ' + student.color + ' 10px, transparent 11px)'}">
  
      <div ng-click="selectUser(student)">
      {{student.name}}<br>
     {{student.level}}<br> 
      </div>

    </li>
  </ul>
   
   
</div>
</div> 
</section>
              
    </div>
          </div>

        </div>
      </div>   
      </div>


  
  
<div class="dashboard-container" style="display: none" id="dashContainer">
  <!--<div class="showbox" ng-if="!userDataLoaded">
      <div class="loader">
        <svg class="circular" viewbox="25 25 50 50">
          <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"></circle>
        </svg>
      </div>
    </div>-->
  
   

    <div class="row">
      <div class="col-sm-5">
        <div class="profile-user-data clearfix">
          <div class="circle">
              <img class="profile-pic" src={{picture}}>
          </div>

          <div class="main-data" >
            <h4 style="font-size: 19px;">{{userData.name}}</h4>
            <div class="pull-left achievement-count" ng-if="userData.plan.split(' ')[0] == 'Premium'" style="color: #77777a; font-size: 12px;"> PLAN PREMIUM
            <i class="ri-vip-crown-fill text-golden"></i>  </div>
        <div class="pull-left achievement-count" ng-if="userData.plan.split(' ')[0] == 'Pro'" style="color: #77777a; font-size: 12px;"> PLAN PRO
            <i class="ri-verified-badge-fill text-blue"></i>  </div>
             <div class="pull-left achievement-count" ng-if="userData.plan.split(' ')[0] == 'Standard'" style="color: #77777a; font-size: 12px;"> PLAN STANDARD
             </div> 
       <div class="pull-left achievement-count" ng-if="userData.plan.split(' ')[0] == 'Estudiante'" style="color: #77777a; font-size: 12px;"> PLAN ESTUDIANTE
            <i class="ri-graduation-cap-fill"></i>  </div> 
            
     <div class="pull-left achievement-count" ng-if="userData.plan == 'Zoom'" style="color: #77777a; font-size: 12px;"> PLAN ZOOM
           <i class="ri-video-chat-fill" style="color: #0B5CFF"></i>  </div>
       <div class="pull-left achievement-count" ng-if="userData.plan == 'Asíncrono'" style="color: #77777a; font-size: 12px;"> PLAN ASÍNCRONO
            <i class="ri-mac-line"></i>  </div> 
        
          <br>
          <div style="margin-top: 1px">    {{userLevel}}  </div>
           

       <div class="progress">
          <div class="progress-bar" style="background-color: {{userData.color}};" role="progressbar" aria-valuemin="0" aria-valuemax="100" ng-style="{width: userData.progress + '%'}" ng-init="startAnimation()"></div>
        </div>

          </div> 
        </div> 
        
       
       
 
        
        <div class="dashboard-panel registry-log-panel" >
          <div class="panel-header">
            <h4><i class="fa fa-fw fa-clock-o"></i> Registro de actividad</h4>
          
          </div>
          <div class="panel-body log-list-container" style="max-height: 220px;"> 
             <ul class="list-unstyled log-list">
             <li ng-repeat="entry in history | filter:filterByLevel" ng-class="{ 'status-completed': entry.status === 'Evaluada', 'status-error': entry.status === 'A corrección', 'status-default': entry.status === 'Límite de entrega: '}">
                <button style="float:right; margin-right: -15px; margin-top: 7px; font-size: 11px; " data-pdf-url="{{entry.pdf}}" onclick="showModal(this)" ng-click="selectEntry(entry)" ng-if="entry.status !== 'En revisión' && entry.status !== 'Evaluada'" class="btn btn-dark btn-sm">Abrir </button>
  
                <div style="float:right; margin-right: -15px;" ng-if="entry.status == 'Evaluada' && entry.quote"><i class="ri-award-fill" style="font-size: 25px; color: orange;"></i>  </div>
               <div ng-if="entry.status == 'Límite de entrega: '" data-youtube-id="{{entry.video}}" 
class="js-trigger-video-modal" onclick="toggle_video_modal(this)" style="color: red; cursor: pointer;"> <i class="ri-youtube-fill yticon" style="float:right; margin-right: 10px; font-size: 26px;"></i></div>
              
                        <span style="font-size: 13px;">{{entry.name}}</span>
               <small style="font-size: 11px; margin-top: 2px;">{{entry.status}} <span ng-if="entry.status == 'Límite de entrega: '"> {{dateToString(entry.limitdate)}}</span></small>
           
               <small ng-if="entry.status == 'Límite de entrega: ' && stringToDate(entry.limitdate) < today" style="font-size: 9px; margin-top: 2px; position:absolute;">Entrega atrasada, envía un avance</small>
                    </li>
            </ul>
           
          </div> 
        </div>
         <button class="back-btn" ng-click="showLoginOptions()" style="position: absolute; bottom: 0; right: 0; width: 150px; margin-bottom: 20px;">Cerrar sesión</button>
      </div>
      <div class="col-sm-7" >
        <div class="dashboard-panel achievement-list-panel" >
          <div class="panel-header">
          <h4><i class="fa fa-fw fa-book"></i> Metrónomo</h4>
          </div>
       <div class="panel-body" >
 
           <iframe width="520px" height="450px" src="https://embed.metronome.app/" id="metronom" frameborder="0">
        </iframe>
          
        </div>
        </div>
      </div>
    </div>
 </div> 
    </div>  

  
  
  
  
  
   <div id="modal-container2" class="modal-container">
  <div class="modal-background" > 
    <div class="modal-msg">
      <br>    
        <div id="status">Cargando...</div>
<button class="close-btn" onclick="hideModal()">✕</button>

          <h2>Oda a la Alegría</h2>
  <p>Ludwig van Beethoven</p>

  
<div class="staffContainer">
  <div id="staff"></div>
</div>
 

             </div>
      <br>

    </div>
  </div>
  




 
  
   <div class="video-modal">
    <div id="video-modal-content" class="video-modal-content">
       <iframe 
          id="youtube" 
          width="100%" 
          height="100%" 
          frameborder="0" 
          allow="autoplay" 
          allowfullscreen 
          src=
        ></iframe>

        <a 
          href="#" 
          class="close-video-modal" 
        >
          <!-- X close video icon -->
          <svg 
            version="1.1" 
            xmlns="http://www.w3.org/2000/svg" 
            xmlns:xlink="http://www.w3.org/1999/xlink"
            x="0"
            y="0"
            viewBox="0 0 32 32" 
            style="enable-background:new 0 0 32 32;" 
            xml:space="preserve" 
            width="24" 
            height="24" 
          >
            <g id="icon-x-close">
                <path fill="#ffffff" d="M30.3448276,31.4576271 C29.9059965,31.4572473 29.4852797,31.2855701 29.1751724,30.980339 L0.485517241,2.77694915 C-0.122171278,2.13584324 -0.104240278,1.13679247 0.52607603,0.517159487 C1.15639234,-0.102473494 2.17266813,-0.120100579 2.82482759,0.477288136 L31.5144828,28.680678 C31.9872448,29.1460053 32.1285698,29.8453523 31.8726333,30.4529866 C31.6166968,31.0606209 31.0138299,31.4570487 30.3448276,31.4576271 Z" id="Shape"></path>
                <path fill="#ffffff" d="M1.65517241,31.4576271 C0.986170142,31.4570487 0.383303157,31.0606209 0.127366673,30.4529866 C-0.12856981,29.8453523 0.0127551942,29.1460053 0.485517241,28.680678 L29.1751724,0.477288136 C29.8273319,-0.120100579 30.8436077,-0.102473494 31.473924,0.517159487 C32.1042403,1.13679247 32.1221713,2.13584324 31.5144828,2.77694915 L2.82482759,30.980339 C2.51472031,31.2855701 2.09400353,31.4572473 1.65517241,31.4576271 Z" id="Shape"></path>
            </g>
          </svg>
        </a>
    </div>
    <div class="overlay"></div>
</div>
</div> 
  


  
</div>
<script>
  
 


  angular.module('studentsApp', [])
  .controller('Controller1', ['$http', '$scope', '$sce', '$timeout', '$interval', function($http, $scope, $sce, $timeout, $interval) {
     
   $scope.userData = [];
 // $scope.userDataLoaded = false;
     $scope.today = new Date()
   

       $scope.isModalVisible = false;
    let deferredPrompt;


    // Registrar el Service Worker
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js').then(function(registration) {
            console.log('ServiceWorker registration successful with scope: ', registration.scope);
        }, function(err) {
            console.log('ServiceWorker registration failed: ', err);
        });
    }

    // Manejar el evento 'beforeinstallprompt'

    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        $scope.isModalVisible = true;
        $scope.$apply(); // Forzar la actualización del scope
    });


    // Función para agregar a la pantalla de inicio
    $scope.addToHomeScreen = function() {
        $scope.isModalVisible = false;
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then((choiceResult) => {
            if (choiceResult.outcome === 'accepted') {
                console.log('User accepted the A2HS prompt');
            } else {
                console.log('User dismissed the A2HS prompt');
            }
            deferredPrompt = null;
        });
    }; 

    // Cerrar modal
    $scope.closeModal = function() {
        $scope.isModalVisible = false;
    };

    // Cerrar modal si se hace clic fuera de él
    $scope.checkCloseModal = function(event) {
        if (event.target.id === 'myModal') {
            $scope.closeModal();
        }
    };
     
    
    
    
    $scope.userData = [];

  $http({
    method: 'GET',
    url: 'https://script.google.com/macros/s/AKfycbzIra465SJypRhzRL6ihOF0dmuCCykgZF3F4PufbHR76OBkyhS7NLvAu0joiJr5VfwM/exec',
    headers: {
      'Content-Type': 'application/json',
      'Accept': 'application/json'
    }
  }).then(function(response) {
    $scope.students = response.data;
     $scope.filterByHour();
  }); 
     
    
      function refreshData() { 
    $http({
    method: 'GET',
    url: 'https://script.google.com/macros/s/AKfycbzIra465SJypRhzRL6ihOF0dmuCCykgZF3F4PufbHR76OBkyhS7NLvAu0joiJr5VfwM/exec',
    headers: {
      'Content-Type': 'application/json',
      'Accept': 'application/json'
    }
  }).then(function(response) {
   $scope.newData = response.data; 
      $scope.stData = $scope.newData[$scope.userData.row-3]; 
      $scope.waitforaudio()
  });
    
  };
  
  var lastmsg = "";
      $scope.waitforaudio = function(){
    if($scope.stData.msg){
      if($scope.stData.msg != lastmsg){
        speak($scope.stData.msg)
        lastmsg = $scope.stData.msg 
      }
    }
  };
  
  function speak(text) {
        var utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'es-ES'; 
    utterance.rate = 1;
        window.speechSynthesis.speak(utterance);
    }
    
    let refreshInterval; 
    $scope.selectUser = function(user){
       document.getElementById('loginContainer').style.display = 'none'; 
            document.getElementById('dashContainer').style.display = 'block';
 /*$("#metronom").attr('src', 'https://embed.metronome.app/'); */
       $scope.userData = user
       $scope.userLevel = $scope.getLevel($scope.userData.lvl)
    $scope.history = $scope.userData.lessons
      
      $scope.startAnimation = function() {
        $('.progress-bar').animate({
          width: $scope.userData.progress + '%'
        }, 500); 
      };
      
    $scope.picture = $scope.userData.photo
       refreshInterval = $interval(refreshData, 1000);
    } 

    $scope.trustAsResourceUrl = function(url) {
        return $sce.trustAsResourceUrl(url);
    };

    
    
    $scope.getLevel = function(lvl){
  if(lvl == 0){
     return "Nivel Preparatorio"
  }else{
    return "Nivel "+lvl.toString()
  }
}
    
      $scope.selectedEntry = null;
    $scope.selectEntry = function(entry) {
       $scope.selectedEntry = entry;
    };
    
    $scope.showLoginOptions = function(){
     document.getElementById('dashContainer').style.display = 'none';
      document.getElementById('loginContainer').style.display = 'block';
      
       document.getElementById('login-options').style.display = 'block';
    document.getElementById('whatsapp-login').style.display = 'none';

    }
    
    
    
    
     $scope.dateToString = function(fechaOriginal){
  const partesFecha = fechaOriginal.split('/');
  const fecha = new Date(partesFecha[2], partesFecha[1] - 1, partesFecha[0]);
  const diasSemana = ["Dom", "Lun", "Mar", "Mié", "Jue", "Vie", "Sáb"];
  const meses = ["Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"];  
  const diaSemana = diasSemana[fecha.getDay()];
  const dia = fecha.getDate();
  const mes = meses[fecha.getMonth()];

  return `${diaSemana} ${dia} de ${mes}`;
}
    
    $scope.stringToDate = function(dateStr) {
  const parts = dateStr.split('/');
  var date = new Date(parts[2], parts[1] - 1, parts[0]);
  date.setDate(date.getDate() + 1);
  return date
}; 
    
  

   $scope.filterByLevel = function(entry) {
    return entry.index <= $scope.userData.lsn ;
};
  
    
   $scope.getCurrentDay = function() {
    var days = ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'];
    var now = new Date();
    return days[now.getDay()];
  };

  $scope.getCurrentHour = function() {
    var now = new Date();
    now.setMinutes(now.getMinutes() + 15);
    var hours = now.getHours();
    //var formattedHours = (hours % 12) || 12;
    return hours
  };
 

  $scope.filteredStudents = [];

  $scope.filterByDay = function() {
    $scope.filteredStudents = $scope.students.filter(function(student) {
      return (((student.classtime[0].split(" ")[0] === $scope.getCurrentDay()) || (student.classtime[1].split(" ")[0] === $scope.getCurrentDay()))  && student.status == 'ACTIVO')
    });
   $scope.noStudentsMessage = $scope.filteredStudents.length === 0 ? 'No hay alumnos en este instante.' : '';
  };

   
  $scope.filterByHour = function() {
    $scope.filteredStudents = $scope.students.filter(function(student) {
     return (((student.classtime[0].split(" ")[0] === $scope.getCurrentDay() && parseInt(student.classtime[0].split(" ")[2].split(":")[0]) === $scope.getCurrentHour()) || (student.classtime[1].split(" ")[0] === $scope.getCurrentDay() && parseInt(student.classtime[1].split(" ")[2].split(":")[0]) === $scope.getCurrentHour()) || (student.online === 1)) && student.status == 'ACTIVO');
    });
  $scope.noStudentsMessage = $scope.filteredStudents.length === 0 ? 'No hay alumnos en este instante.' : '';
  };
  
  
 $scope.showAllStudents = function() {
  $scope.filteredStudents = $scope.students.filter(function(student) {
    return student.status == 'ACTIVO'
  }).sort(function(a, b) {
    return a.name.localeCompare(b.name);
  });
    $scope.noStudentsMessage = '';
};
   
}]); 
  
  
  
  
  
  
  
function toggle_video_modal(element) {
     var url = element.getAttribute('data-youtube-id');
          $("#youtube").attr('src', url);        
          $("body").addClass("show-video-modal noscroll");  
  var icon = element.querySelector('.yticon');
    if (icon) {
        icon.style.animation = 'none';
    } 
}

      // Close and Reset the Video Modal
      function close_video_modal() {
        
        event.preventDefault();
        $("body").removeClass("show-video-modal noscroll");
        $("#youtube").attr('src', '');
        
      } 
      $('body').on('click', '.close-video-modal, .video-modal .overlay', function(event) {
          close_video_modal();
      });
 

  
    function showModal(element) {
       var url = element.getAttribute('data-pdf-url');
          $("#drivemodal").attr('src', url);   
        document.getElementById('modal-container2').classList.add('four');
    };

    function hideModal() {
        const modal = document.getElementById('modal-container2');
       $("#drivemodal").attr('src', '');  
        modal.classList.add('out');
        setTimeout(() => {
            modal.classList.remove('four', 'out');
        }, 400);
    }




    function showWhatsappLogin() {
    document.getElementById('login-options').style.display = 'none';
    document.getElementById('whatsapp-login').style.display = 'block';
}







  const { Renderer, Stave, StaveNote, Voice, Formatter, Accidental, BarNote, StaveConnector } = Vex.Flow;

  // Definimos dos sistemas (renglones) de melodías
  const rightSequences = [
    // Primer sistema
    [64, 64, 65, 67, 67, 65, 64, 62, 60, 60, 62, 64, 62, 60, 60, 60],
    // Segundo sistema (puedes cambiar estas notas)
    [64, 64, 65, 67, 67, 65, 64, 62, 60, 60, 62, 64, 62, 60, 60, 60]
  ];

  const leftSequences = [
    // Primer sistema
    [48, 55, 48, 55],
    // Segundo sistema (puedes cambiar estas notas)
    [48, 55, 48, 55]
  ];

  let currentSystem = 0;
  let currentIndex = 0;
  let pendingNotes = new Set();
  window.leftCompasesPlayed = [new Set(), new Set()]; // Un Set por cada sistema

  function midiToNoteName(midi) {
    const noteNames = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];
    const name = noteNames[midi % 12];
    const octave = Math.floor(midi / 12) - 1;
    return name + octave;
  }

  function midiToVexflowKey(midi) {
    const names = ['c', 'c#', 'd', 'd#', 'e', 'f', 'f#', 'g', 'g#', 'a', 'a#', 'b'];
    const name = names[midi % 12];
    const octave = Math.floor(midi / 12) - 1;
    return `${name}/${octave}`;
  }

  function renderScore() {
    const div = document.getElementById("staff");
    div.innerHTML = "";

    const renderer = new Renderer(div, Renderer.Backends.SVG);
    renderer.resize(800, 450); // Aumentamos la altura para dos sistemas
    const context = renderer.getContext();

    // Primer sistema (renglón)
    const staveTop1 = new Stave(50, 10, 700);
    staveTop1.addClef("treble").addTimeSignature("4/4").setContext(context).draw();

    const staveBottom1 = new Stave(50, 100, 700);
    staveBottom1.addClef("bass").addTimeSignature("4/4").setContext(context).draw();

    const brace1 = new StaveConnector(staveTop1, staveBottom1);
    brace1.setType(StaveConnector.type.BRACE).setContext(context).draw();

    const singleLeft1 = new StaveConnector(staveTop1, staveBottom1);
    singleLeft1.setType(StaveConnector.type.SINGLE_LEFT).setContext(context).draw();

    // Segundo sistema (renglón)
    const staveTop2 = new Stave(50, 200, 700);
    staveTop2.addClef("treble").addTimeSignature("4/4").setContext(context).draw();

    const staveBottom2 = new Stave(50, 290, 700);
    staveBottom2.addClef("bass").addTimeSignature("4/4").setContext(context).draw();

    const brace2 = new StaveConnector(staveTop2, staveBottom2);
    brace2.setType(StaveConnector.type.BRACE).setContext(context).draw();

    const singleLeft2 = new StaveConnector(staveTop2, staveBottom2);
    singleLeft2.setType(StaveConnector.type.SINGLE_LEFT).setContext(context).draw();

    // Renderizar ambos sistemas
    renderSystem(context, staveTop1, staveBottom1, 0);
    renderSystem(context, staveTop2, staveBottom2, 1);
  }

  function renderSystem(context, staveTop, staveBottom, systemIndex) {
    const rightSequence = rightSequences[systemIndex];
    const leftSequence = leftSequences[systemIndex];

    const rightNotes = [];
    for (let i = 0; i < rightSequence.length; i++) {
      const rightKey = midiToVexflowKey(rightSequence[i]);
      const rn = new StaveNote({ keys: [rightKey], duration: "q" });

      if (rightKey.includes("#")) rn.addAccidental(0, new Accidental("#"));
      
      // Resaltar solo las notas del sistema actual
      if (systemIndex === currentSystem) {
        if (i < currentIndex) rn.setStyle({ fillStyle: "green", strokeStyle: "green" });
        else if (i === currentIndex) rn.setStyle({ fillStyle: "orange", strokeStyle: "orange" });
      } else if (systemIndex < currentSystem) {
        // Sistema completado
        rn.setStyle({ fillStyle: "green", strokeStyle: "green" });
      }

      rightNotes.push(rn);

      if ((i + 1) % 4 === 0 && i !== rightSequence.length - 1) {
        rightNotes.push(new BarNote());
      }
    }

    const leftNotes = [];
    for (let i = 0; i < rightSequence.length; i += 4) {
      const compasIndex = i / 4;
      const leftKey = midiToVexflowKey(leftSequence[compasIndex] || 48);
      const leftNote = new StaveNote({
        keys: [leftKey],
        duration: "w",
        clef: "bass"
      });

      if (leftKey.includes("#")) leftNote.addAccidental(0, new Accidental("#"));

      // Resaltar según el sistema actual
      if (systemIndex === currentSystem) {
        if (window.leftCompasesPlayed[systemIndex].has(compasIndex)) {
          leftNote.setStyle({ fillStyle: "green", strokeStyle: "green" });
        } else if (Math.floor(currentIndex / 4) === compasIndex) {
          leftNote.setStyle({ fillStyle: "orange", strokeStyle: "orange" });
        }
      } else if (systemIndex < currentSystem) {
        // Sistema completado
        leftNote.setStyle({ fillStyle: "green", strokeStyle: "green" });
      }

      leftNotes.push(leftNote);

      if (i + 4 < rightSequence.length) {
        leftNotes.push(new BarNote());
      }
    }

    const voiceRight = new Voice({ num_beats: 16, beat_value: 4 });
    voiceRight.addTickables(rightNotes);

    const voiceLeft = new Voice({ num_beats: 16, beat_value: 4 });
    voiceLeft.addTickables(leftNotes);

    const formatter = new Formatter();
    formatter.joinVoices([voiceRight]);
    formatter.joinVoices([voiceLeft]);
    formatter.format([voiceRight, voiceLeft], 650);

    voiceRight.draw(context, staveTop);
    voiceLeft.draw(context, staveBottom);
  }

  function advanceNote() {
    currentIndex++;
    pendingNotes.clear();

    // Verificar si completamos el sistema actual
    if (currentIndex >= rightSequences[currentSystem].length) {
      // Avanzar al siguiente sistema
      currentSystem++;
      currentIndex = 0;
      
      if (currentSystem >= rightSequences.length) {
        document.getElementById("status").textContent = "🎉 ¡Toda la partitura completada!";
        document.getElementById("status").className = "correct";
        return;
      }

       const staffDiv = document.getElementById("staff");
  var systemHeight = 200; 
  staffDiv.scrollTop += systemHeight;
    }

    renderScore();
    document.getElementById("status").textContent = `Sistema ${currentSystem + 1}: Toca ambas notas...`;
    document.getElementById("status").className = "";
  }

  let piano;
  const audioContext = new (window.AudioContext || window.webkitAudioContext)();

  Soundfont.instrument(audioContext, "acoustic_grand_piano").then((p) => {
    piano = p;
    renderScore();
    document.getElementById("status").textContent = "MIDI listo. Toca ambas notas...";
  });

  if (navigator.requestMIDIAccess) {
    navigator.requestMIDIAccess().then((midiAccess) => {
      for (let input of midiAccess.inputs.values()) {
        input.onmidimessage = (msg) => {
          const [command, note, velocity] = msg.data;
          if (command === 144 && velocity > 0) {
            if (piano) piano.play(midiToNoteName(note), audioContext.currentTime, { gain: velocity / 127 });

            const expectedRight = rightSequences[currentSystem][currentIndex];
            const expectedLeftIndex = Math.floor(currentIndex / 4);
            const expectedLeft = leftSequences[currentSystem][expectedLeftIndex];

            if (note === expectedRight) {
              pendingNotes.add('right');
            }

            if (note === expectedLeft && !window.leftCompasesPlayed[currentSystem].has(expectedLeftIndex)) {
              pendingNotes.add('left');
              window.leftCompasesPlayed[currentSystem].add(expectedLeftIndex);
              renderScore();
            }

            if (pendingNotes.has('right') && window.leftCompasesPlayed[currentSystem].has(expectedLeftIndex)) {
              document.getElementById("status").textContent = "✔ ¡Correcto!";
              document.getElementById("status").className = "correct";
              advanceNote();
            } else if (note !== expectedRight && note !== expectedLeft) {
              document.getElementById("status").textContent = "✘ Incorrecto";
              document.getElementById("status").className = "wrong";
            }
          }
        };
      }
    }, () => {
      document.getElementById("status").textContent = "No se pudo acceder a la entrada MIDI";
    });
  } else {
    document.getElementById("status").textContent = "Tu navegador no soporta la Web MIDI API";
  }

</script> 
